<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setups &mdash; k8s-tew  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> k8s-tew
            <img src="_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.4.10
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vagrant">Vagrant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create">Create</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stop">Stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start">Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ssh">SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kubernetes-dashboard">Kubernetes Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ingress-port-forwarding">Ingress Port Forwarding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">k8s-tew</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Setups</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setups.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setups">
<h1>Setups<a class="headerlink" href="#setups" title="Permalink to this heading"></a></h1>
<section id="vagrant">
<h2>Vagrant<a class="headerlink" href="#vagrant" title="Permalink to this heading"></a></h2>
<p>Vagrant/VirtualBox can be used to test drive k8s-tew. The host is used to bootstrap the cluster which runs in VirtualBox. The Vagrantfile included in the repository can be used for single-node/multi-node &amp; Ubuntu 20.04/CentOS 8.2 setups.</p>
<p>The Vagrantfile can be configured using the environment variables:</p>
<ul class="simple">
<li><p>OS - define the operating system. It accepts ubuntu, the default value, and centos.</p></li>
<li><p>MULTI_NODE - if set then a HA cluster is generated. Otherwise a single-node setup is used.</p></li>
<li><p>CONTROLLERS - defines the number of controller nodes. The default number is 3.</p></li>
<li><p>WORKERS - specifies the number of worker nodes. The default number is 2.</p></li>
<li><p>SSH_PUBLIC_KEY - if this environment variable is not set, then <code class="file docutils literal notranslate"><span class="pre">$HOME/.ssh/id_rsa</span></code> is used by default.</p></li>
<li><p>IP_PREFIX - this value is used to generate the IP addresses of the nodes. If not set 192.168.100 will be used. The single node has the IP address 192.168.100.50. The controllers start with the IP address 192.168.100.200 and the workers with 192.168.100.100.</p></li>
<li><p>CONTROLLERS_RAM - amount of RAM for one controller</p></li>
<li><p>WORKERS_RAM - amount of RAM for one worker</p></li>
<li><p>STORAGE_RAM - amount of RAM for one storage</p></li>
<li><p>CONTROLLERS_CPUS - number of CPUs per controller</p></li>
<li><p>WORKERS_CPUS - number of CPUs per worker</p></li>
<li><p>STORAGE_CPUS - number of CPUs per storage</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The multi-node setup with the default settings needs about 20GB RAM for itself.</p>
</div>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h3>
<p>The directory called <code class="file docutils literal notranslate"><span class="pre">setup</span></code> (<a class="reference external" href="https://github.com/darxkies/k8s-tew/tree/2.4.1/setup">https://github.com/darxkies/k8s-tew/tree/2.4.1/setup</a>) contains sub-directories for various cluster setup configurations:</p>
<ul class="simple">
<li><p>local - it starts a single-node cluster locally without using any kind of virtualization. This kind of setup needs root rights. It is meant for local development where it might be important to fire the cluster up and shut it down fast. If you want it to start automatically, take a look at the quickstart section.</p></li>
<li><p>ubuntu-single-node - Ubuntu 20.04 single-node cluster. It needs about 8GB Ram.</p></li>
<li><p>ubuntu-multi-node - Ubuntu 20.04 HA cluster. It needs around 20GB Ram.</p></li>
<li><p>centos-single-node - CentOS 8.2 single-node cluster. It needs about 8GB Ram.</p></li>
<li><p>centos-multi-node - CentOS 8.2 HA cluster. It needs around 20GB Ram.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regardless of the setup, once the deployment is done it will take a while to download all required containers from the internet. So better use kubectl to check the status of the pods.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the local setup, to access the Kubernetes Dashboard use the internal IP address (e.g. 192.168.x.y or 10.x.y.z) and not 127.0.0.1/localhost. Depending on the hardware used, it might take a while until it starts and setups everything.</p>
</div>
</section>
<section id="create">
<h3>Create<a class="headerlink" href="#create" title="Permalink to this heading"></a></h3>
<p>Change to one of the sub-directories and enter the following command to start the cluster:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will destroy any existing VMs, creates new VMs and performs all the steps (forced initialization, configuration, generation and deployment) to create the cluster.</p>
</div>
</section>
<section id="stop">
<h3>Stop<a class="headerlink" href="#stop" title="Permalink to this heading"></a></h3>
<p>For the local setup, just press CTRL+C.</p>
<p>For the other setups enter:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make halt
</pre></div>
</div>
</div></blockquote>
</section>
<section id="start">
<h3>Start<a class="headerlink" href="#start" title="Permalink to this heading"></a></h3>
<p>To start an existing setup/VMs enter:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make up
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This and the following commands work only for Vagrant based setups.</p>
</div>
</section>
<section id="ssh">
<h3>SSH<a class="headerlink" href="#ssh" title="Permalink to this heading"></a></h3>
<p>For single-node setups enter:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make ssh
</pre></div>
</div>
</div></blockquote>
<p>And for multi-node setups:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make ssh-controller00
make ssh-controller01
make ssh-controller02
make ssh-worker00
make ssh-worker01
</pre></div>
</div>
</div></blockquote>
</section>
<section id="kubernetes-dashboard">
<h3>Kubernetes Dashboard<a class="headerlink" href="#kubernetes-dashboard" title="Permalink to this heading"></a></h3>
<p>This will display the token, and then it will open the web browser pointing to the address of Kubernetes Dashboard:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make dashboard
</pre></div>
</div>
</div></blockquote>
</section>
<section id="ingress-port-forwarding">
<h3>Ingress Port Forwarding<a class="headerlink" href="#ingress-port-forwarding" title="Permalink to this heading"></a></h3>
<p>In order to start port forwarding from your host’s ports 80 and 443 to Vagrant’s VMs for Ingress enter:</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make forward-80
make forward-443
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both commands are blocking. So you need two different terminal sessions.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Mircea-Cristian Racasan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>